{{- if .Values.configMap.create }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.configMap.name | default "clockwork-config" }}
  namespace: {{ .Values.namespace.name | default "clockwork" }}
  labels:
    app.kubernetes.io/name: clockwork
    app.kubernetes.io/instance: {{ .Release.Name }}
    app.kubernetes.io/version: {{ .Chart.AppVersion | quote }}
    app.kubernetes.io/managed-by: {{ .Release.Service }}
    {{- if .Values.configMap.values.env }}
    environment: {{ .Values.configMap.values.env }}
    {{- end }}
data:
  # Environment mode: development or production
  ENV: {{ .Values.configMap.values.env | default "development" | quote }}
  # CORS allowed origins (comma-separated)
  # Empty string means use default (app will default to "*" in development)
  ALLOWED_ORIGINS: {{ .Values.configMap.values.allowedOrigins | default "" | quote }}
  # Whether to run migrations on startup
  # "true" for auto-migrate, "false" for manual migrations via Job
  DB_AUTO_MIGRATE: {{ .Values.configMap.values.dbAutoMigrate | default "false" | quote }}
{{- end }}

